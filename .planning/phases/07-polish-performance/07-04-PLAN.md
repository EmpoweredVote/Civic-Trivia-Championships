---
phase: 07-polish-performance
plan: 04
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - frontend/src/features/game/components/AnswerGrid.tsx
  - frontend/src/features/game/components/GameTimer.tsx
  - frontend/src/features/game/components/GameScreen.tsx
  - frontend/src/features/game/components/ResultsScreen.tsx
  - frontend/src/features/game/components/ScoreDisplay.tsx
  - frontend/src/features/game/components/WagerScreen.tsx
  - frontend/src/features/game/components/LearnMoreButton.tsx
  - frontend/src/features/game/components/QuestionCard.tsx
  - frontend/src/index.css
  - frontend/src/components/layout/Header.tsx
  - frontend/src/pages/Dashboard.tsx
  - frontend/src/pages/Login.tsx
  - frontend/src/pages/Signup.tsx
autonomous: true

must_haves:
  truths:
    - "Correct answers show checkmark icon alongside green color"
    - "Incorrect answers show X icon alongside red color"
    - "Timeout answers show clock icon alongside amber color"
    - "Timer has pulsing animation at low time AND icon changes at thresholds"
    - "All text meets 4.5:1 contrast ratio against backgrounds"
    - "All interactive elements have minimum 48px touch targets"
    - "Color is never used alone to convey meaning"
  artifacts:
    - path: "frontend/src/features/game/components/AnswerGrid.tsx"
      provides: "Answer buttons with checkmark/X icons on reveal"
      contains: "checkmark|check-icon|correct-icon"
    - path: "frontend/src/features/game/components/GameTimer.tsx"
      provides: "Timer with pulsing and icon changes at thresholds"
      contains: "pulse|pulsing"
  key_links:
    - from: "frontend/src/features/game/components/AnswerGrid.tsx"
      to: "icon indicators"
      via: "SVG icons rendered conditionally on reveal phase"
      pattern: "isRevealing.*icon|checkmark|x-icon"
    - from: "frontend/src/features/game/components/GameTimer.tsx"
      to: "threshold animations"
      via: "pulsing animation and icon at low time"
      pattern: "remainingTime.*<=.*pulse|animate.*scale"
---

<objective>
Implement color-independent indicators (A11Y-03), WCAG AA contrast compliance (A11Y-04), and minimum touch targets (A11Y-05) across the entire app. Add icons alongside colors for answer feedback and timer states, audit and fix contrast ratios, and ensure all touch targets meet 48px minimum.

Purpose: Ensures no information is conveyed by color alone, all text is readable, and mobile users can reliably tap all interactive elements.
Output: WCAG AA compliant UI with icon+color indicators throughout.
</objective>

<execution_context>
@C:\Users\Chris\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Chris\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@C:\Project Test\.planning\PROJECT.md
@C:\Project Test\.planning\ROADMAP.md
@C:\Project Test\.planning\phases\07-polish-performance\07-CONTEXT.md
@C:\Project Test\.planning\phases\07-polish-performance\07-RESEARCH.md

Key existing files:
@C:\Project Test\frontend\src\features\game\components\AnswerGrid.tsx
@C:\Project Test\frontend\src\features\game\components\GameTimer.tsx
@C:\Project Test\frontend\src\features\game\components\GameScreen.tsx
@C:\Project Test\frontend\src\features\game\components\ResultsScreen.tsx
@C:\Project Test\frontend\src\features\game\components\ScoreDisplay.tsx
@C:\Project Test\frontend\src\features\game\components\WagerScreen.tsx
@C:\Project Test\frontend\src\features\game\components\LearnMoreButton.tsx
@C:\Project Test\frontend\src\index.css
@C:\Project Test\frontend\src\components\layout\Header.tsx
@C:\Project Test\frontend\src\pages\Dashboard.tsx
@C:\Project Test\frontend\src\pages\Login.tsx
@C:\Project Test\frontend\src\pages\Signup.tsx

Prior plan context (07-01 must be complete):
@C:\Project Test\.planning\phases\07-polish-performance\07-01-PLAN.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add icon indicators alongside color for answer feedback and timer</name>
  <files>
    frontend/src/features/game/components/AnswerGrid.tsx
    frontend/src/features/game/components/GameTimer.tsx
    frontend/src/features/game/components/GameScreen.tsx
    frontend/src/features/game/components/ResultsScreen.tsx
  </files>
  <action>
    1. Update `AnswerGrid.tsx` to add icons during reveal phase:
       - When revealing and answer is CORRECT (index === correctAnswer):
         - Add a checkmark SVG icon (green, w-6 h-6) at the RIGHT side of the button
         - Use this inline SVG: `<svg className="w-6 h-6 text-green-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" /></svg>`
       - When revealing and answer is WRONG and was selected (index === selectedOption && index !== correctAnswer):
         - Add an X SVG icon (red, w-6 h-6) at the RIGHT side of the button
         - Use: `<svg className="w-6 h-6 text-red-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clipRule="evenodd" /></svg>`
       - Icons should animate in with a slight delay (opacity 0 to 1 with 0.3s delay via framer-motion)

    2. Update `GameTimer.tsx` to add visual indicators beyond color:
       - Add an icon that changes at thresholds:
         - Normal (>10s): no extra icon, just the timer number
         - Warning (<=10s, >5s): Add a small amber clock icon next to the number
         - Critical (<=5s): Change to a red exclamation triangle icon, start pulsing
       - Add pulsing animation at critical time (<=5s):
         - Wrap the timer container in a motion.div with:
           ```ts
           animate={remainingTime <= 5 ? { scale: [1, 1.08, 1] } : {}}
           transition={{ repeat: Infinity, duration: 0.6 }}
           ```
         - This adds visual motion cue alongside the existing red color, serving both accessibility AND dramatic tension
       - To access remainingTime for these effects, use the existing render prop from CountdownCircleTimer which provides `remainingTime`
       - At <=10s, add a slight CSS border glow: `border border-amber-500/50` around the timer
       - At <=5s, intensify: `border border-red-500/70 shadow-lg shadow-red-500/30`

    3. Update `GameScreen.tsx` timeout flash:
       - The "Time's up!" flash message (line ~288-300) currently uses just red color
       - Add a clock/timer icon before "Time's up!" text:
         ```tsx
         <svg className="w-8 h-8 text-white inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
           <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
         </svg>
         ```

    4. Update `ResultsScreen.tsx` answer review section:
       - In the collapsed accordion view, next to each question's points badge:
         - Correct: green checkmark icon (small, w-5 h-5) before the points number
         - Wrong: red X icon (small, w-5 h-5) before the points number
         - Timeout: amber clock icon (small, w-5 h-5) before the points number
       - These icons reinforce the color coding (teal for correct, red for wrong, amber for timeout) that already exists in the points text color
  </action>
  <verify>
    Run `cd frontend && npm run build` to verify compilation. Inspect AnswerGrid for checkmark/X icon SVGs. Inspect GameTimer for pulse animation and threshold border changes.
  </verify>
  <done>
    Answer feedback shows checkmark (correct) and X (incorrect) icons alongside color. Timer pulses at low time with icon changes at 10s and 5s thresholds. Timeout flash has clock icon. Results screen accordion has status icons per question. No meaning is conveyed by color alone.
  </done>
</task>

<task type="auto">
  <name>Task 2: WCAG AA contrast audit and touch target enforcement</name>
  <files>
    frontend/src/index.css
    frontend/src/features/game/components/AnswerGrid.tsx
    frontend/src/features/game/components/ScoreDisplay.tsx
    frontend/src/features/game/components/WagerScreen.tsx
    frontend/src/features/game/components/LearnMoreButton.tsx
    frontend/src/features/game/components/QuestionCard.tsx
    frontend/src/components/layout/Header.tsx
    frontend/src/pages/Dashboard.tsx
    frontend/src/pages/Login.tsx
    frontend/src/pages/Signup.tsx
  </files>
  <action>
    1. **Contrast audit** - Check all text/background color combinations against WCAG AA 4.5:1 ratio.

       Key areas to check and fix (dark game-show background is typically slate-900 #0f172a or slate-800 #1e293b):

       a) `text-slate-400` (#94a3b8) on slate-900 (#0f172a): Contrast ratio ~4.5:1 - BORDERLINE. Increase to `text-slate-300` (#cbd5e1) which gives ~8:1 for body text that needs to be readable. Apply to:
          - Header user name text
          - Profile page labels
          - Score breakdown text in ResultsScreen
          - Timer labels, wager labels

       b) `text-slate-500` (#64748b) on slate-900: ~3:1 - FAILS AA. Replace with `text-slate-400` (#94a3b8) minimum for text elements. Check:
          - "No points awarded" text in ResultsScreen
          - "played for fun" text in ResultsScreen
          - Helper text in various forms

       c) `text-teal-400` (#2dd4bf) on slate-900: ~7:1 - PASSES. No change needed.

       d) `text-amber-500` (#f59e0b) on slate-900: ~6.5:1 - PASSES. No change needed.

       e) `text-red-400` (#f87171) on slate-900: ~5:1 - PASSES. No change needed.

       f) `text-green-400` (#4ade80) on green-600/30 bg: Check this combination. The correct answer has green text on semi-transparent green bg over slate. May need to brighten text.

       g) `border-slate-600` (#475569) on slate-900: For UI components (borders), need 3:1. This is ~2.3:1 - FAILS. Use `border-slate-500` (#64748b) which gives ~3:1.

       h) Header: Currently white bg with gray text - this is fine for contrast. But check the teal-600 logo text on white: ~4.5:1 - borderline, acceptable for large text.

       i) Login/Signup pages: Check form field labels, placeholder text, error messages against their backgrounds.

       Apply fixes:
       - Where `text-slate-400` is used for important readable text, upgrade to `text-slate-300`
       - Where `text-slate-500` is used for readable content, upgrade to `text-slate-400`
       - Where `border-slate-600` is decorative separating content, upgrade to `border-slate-500`
       - Preserve the dark game-show feel - adjust shades/tints, don't switch color families

    2. **Touch target enforcement** - Minimum 48x48px for all interactive elements:

       a) AnswerGrid buttons: Already large (p-4 with text), well above 48px. No change.

       b) Close buttons on modals (LearnMoreModal, ConfirmDialog): The close button is just an SVG icon. Add `min-w-[48px] min-h-[48px]` and `p-3` to ensure the tap area is large enough.

       c) Header hamburger menu button: Currently `p-2` with 24px icon = ~40px. Add `min-w-[48px] min-h-[48px]` class.

       d) Quit button in GameScreen: Currently `p-2` with 24px icon = ~40px. Add `min-w-[48px] min-h-[48px]` class.

       e) Progress dots: These are display-only (not interactive), no change needed.

       f) LearnMoreButton: Check its size. Should have `min-h-[48px]` if it's a small button.

       g) ResultsScreen accordion buttons: Already full-width with p-4, well above 48px.

       h) WagerScreen slider thumb: Currently 24px (set in inline styles). Increase to 28px minimum. The actual touch area on mobile includes the surrounding track, so 24px visual with the track gives adequate touch area. Leave as-is but add `touch-action: none` CSS for better mobile slider behavior.

       i) Login/Signup form submit buttons: Check - likely already large. Ensure `min-h-[48px]`.

       j) Profile page buttons: Check play CTA, retry button. Ensure `min-h-[48px]`.

    3. Add a CSS utility in `frontend/src/index.css`:
       ```css
       /* Minimum touch target size for accessibility */
       .touch-target {
         min-width: 48px;
         min-height: 48px;
       }
       ```

    4. On all pages (Dashboard, Login, Signup, Profile), do a quick scan for:
       - Any text below 4.5:1 contrast (mainly watch for slate-500 text on dark backgrounds)
       - Any buttons/links smaller than 48px
       - Fix as found
  </action>
  <verify>
    Run `cd frontend && npm run build` to verify compilation. Manually check that:
    - No text-slate-500 remains on dark backgrounds for readable content
    - Close buttons have min 48px dimensions
    - All border colors updated from slate-600 to slate-500 where they separate content
  </verify>
  <done>
    All text meets 4.5:1 contrast ratio against their backgrounds (slate-400 minimum for secondary text on dark bg, slate-300 for body text). UI component borders meet 3:1 (slate-500 minimum on dark bg). All interactive elements have minimum 48px touch targets. Color-only indicators replaced with color+icon throughout. Dark game-show aesthetic preserved with adjusted shades.
  </done>
</task>

</tasks>

<verification>
- `cd frontend && npm run build` succeeds
- AnswerGrid shows checkmark/X icons during reveal alongside colors
- GameTimer pulses at low time and changes border/icon at thresholds
- No text-slate-500 on dark backgrounds for readable content
- All close buttons, menu buttons, quit buttons have min 48px dimensions
- ResultsScreen accordion items have status icons
</verification>

<success_criteria>
- Checkmark icon appears next to correct answer on reveal
- X icon appears next to incorrect selected answer on reveal
- Clock icon appears for timeout in results review
- Timer pulses and shows warning/critical icons at 10s and 5s
- All text: 4.5:1 contrast minimum (normal), 3:1 for large text and UI components
- All interactive elements: 48px minimum touch target
- Color is never the sole indicator of meaning anywhere in the app
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish-performance/07-04-SUMMARY.md`
</output>
