---
phase: 02-game-core
plan: 03
type: execute
wave: 3
depends_on: ["02-01", "02-02"]
files_modified:
  - frontend/src/features/game/components/GameScreen.tsx
  - frontend/src/features/game/components/QuestionCard.tsx
  - frontend/src/features/game/components/AnswerGrid.tsx
  - frontend/src/features/game/components/GameTimer.tsx
  - frontend/src/features/game/components/ProgressDots.tsx
  - frontend/src/shared/components/ConfirmDialog.tsx
autonomous: true

must_haves:
  truths:
    - "Game screen shows question text, 4 answer options in 2x2 grid (desktop) / vertical stack (mobile), circular timer, and progress dots"
    - "Selecting an answer highlights it, player can change selection before locking in"
    - "Lock In button confirms selection and triggers 1.5s suspense pause"
    - "During reveal, wrong options fade out, correct answer highlighted, explanation shown inline"
    - "Timer runs during answering phase, pauses on lock-in, depletes with color transitions teal->yellow->orange->red"
    - "Keyboard shortcuts A/B/C/D select answers during answering phase"
    - "Quit button shows confirmation dialog, quitting returns to idle"
  artifacts:
    - path: "frontend/src/features/game/components/GameScreen.tsx"
      provides: "Main game container orchestrating all game components"
      exports: ["GameScreen"]
      min_lines: 80
    - path: "frontend/src/features/game/components/QuestionCard.tsx"
      provides: "Question text display with topic indicator"
      exports: ["QuestionCard"]
    - path: "frontend/src/features/game/components/AnswerGrid.tsx"
      provides: "2x2 responsive answer grid with letter labels and animations"
      exports: ["AnswerGrid"]
      min_lines: 60
    - path: "frontend/src/features/game/components/GameTimer.tsx"
      provides: "Circular countdown timer with color transitions"
      exports: ["GameTimer"]
    - path: "frontend/src/features/game/components/ProgressDots.tsx"
      provides: "10 progress dots showing current question position"
      exports: ["ProgressDots"]
    - path: "frontend/src/shared/components/ConfirmDialog.tsx"
      provides: "Reusable confirmation dialog with overlay"
      exports: ["ConfirmDialog"]
  key_links:
    - from: "frontend/src/features/game/components/GameScreen.tsx"
      to: "frontend/src/features/game/hooks/useGameState.ts"
      via: "useGameState() hook call"
      pattern: "useGameState"
    - from: "frontend/src/features/game/components/GameScreen.tsx"
      to: "frontend/src/features/game/hooks/useKeyPress.ts"
      via: "useKeyPress() for A/B/C/D shortcuts"
      pattern: "useKeyPress"
    - from: "frontend/src/features/game/components/AnswerGrid.tsx"
      to: "framer-motion"
      via: "motion.button for fade animations"
      pattern: "motion\\.button|motion\\.div"
    - from: "frontend/src/features/game/components/GameTimer.tsx"
      to: "react-countdown-circle-timer"
      via: "CountdownCircleTimer component"
      pattern: "CountdownCircleTimer"
---

<objective>
Build all game screen UI components: the main GameScreen container, QuestionCard, AnswerGrid with Framer Motion animations, GameTimer with circular countdown, ProgressDots, and a reusable ConfirmDialog for quit confirmation. These components consume the useGameState hook from Plan 02 and render the complete game experience.

Purpose: This is the visual layer of the game — the Who Wants to Be a Millionaire aesthetic with dark background, dramatic reveal animations, circular timer, and letter-labeled answer options. Without these components, the state machine has no interface.
Output: 6 React components that together render a complete playable game screen.
</objective>

<execution_context>
@C:\Users\Chris\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Chris\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-game-core/02-CONTEXT.md
@.planning/phases/02-game-core/02-RESEARCH.md
@.planning/phases/02-game-core/02-01-SUMMARY.md
@.planning/phases/02-game-core/02-02-SUMMARY.md
@frontend/src/types/game.ts
@frontend/src/features/game/gameReducer.ts
@frontend/src/features/game/hooks/useGameState.ts
@frontend/src/features/game/hooks/useKeyPress.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GameTimer, ProgressDots, QuestionCard, and ConfirmDialog components</name>
  <files>
    frontend/src/features/game/components/GameTimer.tsx
    frontend/src/features/game/components/ProgressDots.tsx
    frontend/src/features/game/components/QuestionCard.tsx
    frontend/src/shared/components/ConfirmDialog.tsx
  </files>
  <action>
    **GameTimer.tsx:**
    - Uses `CountdownCircleTimer` from `react-countdown-circle-timer`
    - Props: `duration: number` (20), `onTimeout: () => void`, `isPaused: boolean`, `key: string | number` (to reset timer per question)
    - Colors array: `['#14B8A6', '#FBBF24', '#F97316', '#EF4444']` (teal, yellow, orange, red)
    - ColorsTime: `[20, 10, 5, 0]` (transitions at 50%, 25%, and final seconds)
    - Size: 80px, strokeWidth: 6
    - Renders remaining seconds as number inside the ring (large, bold, white text)
    - Positioned in top-right of game screen (positioning handled by parent)
    - onComplete callback triggers onTimeout prop

    **ProgressDots.tsx:**
    - Props: `currentIndex: number`, `total: number` (default 10)
    - Renders a row of 10 small dots (like Millionaire's money ladder but horizontal)
    - Current question dot is filled/highlighted (teal), past questions are dimmed, future are neutral outline
    - NO correct/incorrect coloring — per CONTEXT.md, neutral fill only
    - Use Tailwind: `w-3 h-3 rounded-full` with conditional bg colors
    - Positioned above the question (styling handled by parent)

    **QuestionCard.tsx:**
    - Props: `question: Question`, `questionNumber: number`
    - Displays question text prominently, centered, large font
    - Shows subtle topic indicator (small text or badge above question, e.g., "Constitution")
    - Question number shown as "3 of 10" format in the HUD area (or passed up to parent)
    - Tailwind styling: white/light text on dark background, text-xl or text-2xl for question, max-width for readability
    - Handle long question text: allow wrapping, no truncation

    **ConfirmDialog.tsx** (in shared/components for reuse):
    - Props: `isOpen: boolean`, `onConfirm: () => void`, `onCancel: () => void`, `title: string`, `message: string`, `confirmText?: string` (default "Confirm"), `cancelText?: string` (default "Cancel")
    - Uses Framer Motion AnimatePresence for enter/exit animations
    - Overlay: semi-transparent black backdrop, clicking it calls onCancel
    - Dialog box: centered, dark background with border, rounded corners
    - Two buttons: cancel (secondary) and confirm (primary/danger)
    - `role="dialog"` and `aria-modal="true"` for accessibility
    - Locks body scroll when open (optional, nice to have)
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` to verify all components compile.
    Check that imports resolve correctly (react-countdown-circle-timer, framer-motion).
  </verify>
  <done>
    GameTimer renders circular countdown with color transitions. ProgressDots shows 10 neutral dots. QuestionCard displays question text with topic. ConfirmDialog provides reusable confirmation overlay. All compile without errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create AnswerGrid and GameScreen container</name>
  <files>
    frontend/src/features/game/components/AnswerGrid.tsx
    frontend/src/features/game/components/GameScreen.tsx
  </files>
  <action>
    **AnswerGrid.tsx:**
    - Props: `options: string[]`, `selectedOption: number | null`, `correctAnswer: number`, `phase: GamePhase`, `onSelect: (index: number) => void`, `onLockIn: () => void`, `explanation: string`
    - Layout: CSS Grid, 2 columns on desktop (min-width: 768px), 1 column on mobile
    - Each option is a `motion.button` from Framer Motion with:
      - Letter label (A, B, C, D) on the left, prominent
      - Option text to the right of the letter
      - Uniform styling — all options same color scheme (dark bg, light text, subtle border)
    - **States by game phase:**
      - `answering`: All options clickable, hover effects
      - `selected`: Selected option highlighted (teal border/glow), others normal, clicking another option changes selection. Show "Lock In" button below the grid.
      - `locked`: Selected option highlighted, all options disabled, suspense state
      - `revealing`:
        - Correct answer: bright green highlight, subtle scale up (1.05)
        - Player's wrong pick (if any): red highlight, stays visible
        - Other wrong options: fade to opacity 0.3
        - Show explanation text below the grid (1-3 sentences)
        - If player was wrong, show "Not quite" text above explanation (never "Wrong")
        - Show "Next" button (or auto-advance countdown)
    - Lock In button: appears only in 'selected' phase, prominent teal button below grid
    - Next button: appears only in 'revealing' phase, secondary style
    - Disable pointer events on options during 'locked' and 'revealing' phases
    - Animations: use Framer Motion `animate` prop for opacity and scale transitions, duration 0.5s

    **GameScreen.tsx:**
    - Main container component that orchestrates the entire game
    - Calls `useGameState()` hook for all state and actions
    - Sets up keyboard shortcuts using `useKeyPress()`:
      - 'a' -> selectAnswer(0)
      - 'b' -> selectAnswer(1)
      - 'c' -> selectAnswer(2)
      - 'd' -> selectAnswer(3)
      - Only enabled when phase is 'answering' or 'selected'
    - **Layout (Millionaire aesthetic):**
      - Full viewport height, dark background (slate-900 or darker)
      - Subtle gradient or radial gradient from center (slight light bloom)
      - Centered content, max-width container
      - Top area: ProgressDots (left/center), question number "X of 10" (center), GameTimer (right), quit button (top-left, small X icon)
      - Middle area: QuestionCard (question text, centered, large)
      - Bottom area: AnswerGrid (4 options)
    - **Phase-specific rendering:**
      - `idle`: Show "Quick Play" start button (large, centered, teal, inviting). Simple layout, no game elements.
      - `answering`/`selected`: Full game layout with timer running
      - `locked`: Full game layout, timer paused, suspense state
      - `revealing`: Full game layout, timer paused, answer reveal with explanation
      - `complete`: Don't render game screen (parent will route to results — but for now, show a simple "Game Complete" message until Plan 04 adds ResultsScreen)
    - **Quit functionality:**
      - Small X or "Quit" button in top-left corner
      - Opens ConfirmDialog: "Are you sure you want to quit? Your progress will be lost."
      - Confirm: calls quitGame()
      - Cancel: closes dialog, game continues (timer should be paused while dialog is open)
    - **Timeout handling:**
      - When timer completes (onTimeout), show brief "Time's up!" flash text (1s), then reveal the correct answer
      - Use a local state or short timeout for the flash before calling handleTimeout
    - No nav bar — full immersive mode per CONTEXT.md
    - Question transitions: use Framer Motion AnimatePresence with fade/slide for question changes (keyed by currentQuestionIndex)
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` to verify everything compiles.
    Check that GameScreen imports and uses all child components (GameTimer, ProgressDots, QuestionCard, AnswerGrid, ConfirmDialog).
    Check that useGameState and useKeyPress hooks are properly connected.
    Verify CSS Grid responsive behavior is defined (2 columns desktop, 1 column mobile).
  </verify>
  <done>
    AnswerGrid renders 4 options with letter labels, two-step lock-in flow, Framer Motion reveal animations, and explanation display. GameScreen orchestrates all components with keyboard shortcuts, quit dialog, timeout handling, and Millionaire-style dark aesthetic. Full game is playable from idle through all questions.
  </done>
</task>

</tasks>

<verification>
- `cd frontend && npx tsc --noEmit` passes
- All 6 components export correctly
- GameScreen uses useGameState hook
- Keyboard shortcuts wired for A/B/C/D
- ConfirmDialog uses Framer Motion AnimatePresence
- AnswerGrid has responsive 2x2 / 1-column layout
- GameTimer uses react-countdown-circle-timer with correct colors
- No hardcoded question data (all from state)
</verification>

<success_criteria>
- Complete game screen renders with dark Millionaire aesthetic
- Answer grid is 2x2 on desktop, vertical stack on mobile
- Circular timer shows countdown with teal->yellow->orange->red transitions
- Two-step lock-in works (select then confirm)
- Reveal animation fades wrong options, highlights correct answer
- Explanation shown during reveal phase
- Keyboard shortcuts A/B/C/D work for answer selection
- Quit dialog pauses game and confirms before quitting
- Progress dots show current question position
</success_criteria>

<output>
After completion, create `.planning/phases/02-game-core/02-03-SUMMARY.md`
</output>
