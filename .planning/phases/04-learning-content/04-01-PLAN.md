---
phase: 04-learning-content
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/types/game.ts
  - frontend/src/features/game/components/TopicIcon.tsx
  - backend/src/data/questions.json
  - backend/src/scripts/generateLearningContent.ts
  - frontend/package.json
autonomous: true

must_haves:
  truths:
    - "At least 10 topic categories exist with icon components"
    - "At least 15 questions have complete learningContent (paragraphs + corrections + source)"
    - "Every question has a topicCategory field from the granular category set"
    - "Question type includes optional learningContent field"
    - "A build script exists for bulk-generating remaining content via Claude API"
  artifacts:
    - path: "frontend/src/types/game.ts"
      provides: "LearningContent type, TopicCategory type, updated Question type"
      contains: "LearningContent"
    - path: "frontend/src/features/game/components/TopicIcon.tsx"
      provides: "SVG icon components for each topic category"
      contains: "TOPIC_ICONS"
    - path: "backend/src/data/questions.json"
      provides: "Questions with topicCategory and learningContent fields"
      contains: "learningContent"
    - path: "backend/src/scripts/generateLearningContent.ts"
      provides: "Build-time script for AI content generation"
      contains: "generateLearningContent"
  key_links:
    - from: "frontend/src/types/game.ts"
      to: "backend/src/data/questions.json"
      via: "Question type matches JSON structure"
      pattern: "topicCategory.*TopicCategory"
    - from: "frontend/src/features/game/components/TopicIcon.tsx"
      to: "frontend/src/types/game.ts"
      via: "TopicCategory keys match icon map"
      pattern: "Record<TopicCategory"
---

<objective>
Define the learning content data model, create topic category icons, and author educational content for a representative subset of questions.

Purpose: Establishes the data foundation that all Learn More UI components will consume. Without types, topic icons, and actual content in questions.json, the UI plans have nothing to render.

Output: Updated Question type with LearningContent, TopicIcon component with 9 category icons, ~15 questions with full learningContent in questions.json, and a generation script for bulk content creation.
</objective>

<execution_context>
@C:\Users\Chris\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Chris\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-learning-content/04-CONTEXT.md
@.planning/phases/04-learning-content/04-RESEARCH.md
@frontend/src/types/game.ts
@backend/src/data/questions.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define learning content types, install Headless UI, create topic icons</name>
  <files>
    frontend/src/types/game.ts
    frontend/src/features/game/components/TopicIcon.tsx
    frontend/package.json
  </files>
  <action>
1. Install @headlessui/react in the frontend:
   ```
   cd frontend && npm install @headlessui/react
   ```

2. Update `frontend/src/types/game.ts` to add:
   - `TopicCategory` type union with exactly these 9 categories:
     `'voting' | 'elections' | 'congress' | 'executive' | 'judiciary' | 'bill-of-rights' | 'amendments' | 'federalism' | 'civic-participation'`
   - `LearningContent` type with fields:
     - `topic: TopicCategory`
     - `paragraphs: string[]` (2-3 paragraphs)
     - `corrections: Record<string, string>` (keys are option indices as strings for wrong answers, values are correction text)
     - `source: { name: string; url: string }`
   - Add `topicCategory: TopicCategory` as REQUIRED field on Question type
   - Add `learningContent?: LearningContent` as OPTIONAL field on Question type
   - Keep ALL existing fields unchanged

3. Create `frontend/src/features/game/components/TopicIcon.tsx`:
   - Export individual SVG icon components for each of the 9 topic categories
   - Use line-art style (stroke-based, no fill) to match Millionaire game aesthetic
   - Each icon: `({ className = "w-5 h-5" }: { className?: string }) => JSX.Element`
   - Icons should represent:
     - voting: ballot box / checkbox
     - elections: podium / campaign
     - congress: capitol building
     - executive: seal / eagle
     - judiciary: scales of justice
     - bill-of-rights: scroll / document
     - amendments: quill pen / document with plus
     - federalism: connected nodes / states
     - civic-participation: raised hand / people
   - Export `TOPIC_ICONS: Record<TopicCategory, React.FC<{ className?: string }>>` mapping each category to its icon
   - Export `TOPIC_LABELS: Record<TopicCategory, string>` mapping each category to a human-readable label (e.g., 'bill-of-rights' -> 'Bill of Rights', 'civic-participation' -> 'Civic Participation')
  </action>
  <verify>
    - `cd frontend && npx tsc --noEmit` passes with no type errors
    - `@headlessui/react` appears in frontend/package.json dependencies
    - TopicIcon.tsx exports TOPIC_ICONS with all 9 categories
  </verify>
  <done>
    - LearningContent and TopicCategory types defined in game.ts
    - Question type extended with topicCategory (required) and learningContent (optional)
    - 9 SVG topic icon components created with TOPIC_ICONS map and TOPIC_LABELS map
    - @headlessui/react installed
  </done>
</task>

<task type="auto">
  <name>Task 2: Author learning content for 15+ questions and remap topic categories</name>
  <files>
    backend/src/data/questions.json
    backend/src/scripts/generateLearningContent.ts
  </files>
  <action>
1. Update ALL 120 questions in `backend/src/data/questions.json` to add a `topicCategory` field, mapping existing topic strings to the new granular categories:
   - "Constitution" -> "bill-of-rights" (for Bill of Rights questions) or "amendments" (for amendment questions) or "federalism" (for structural questions). Judge each question individually.
   - "Supreme Court" -> "judiciary"
   - "Branches of Government" -> "congress" or "executive" or "judiciary" depending on the specific question content
   - "Amendments" -> "amendments"
   - "Elections" -> "elections"
   - "U.S. History" -> whichever category best fits
   - "Civic Participation" -> "civic-participation"
   Ensure all 9 topic categories are represented (at least 1 question each).

2. Write full `learningContent` for at least 15 questions, ensuring coverage of ALL 9 topic categories (at least 1 per category, more for larger categories). Select questions that are diverse and educational. For each:
   - `topic`: Must match the question's `topicCategory` field
   - `paragraphs`: Array of 2-3 paragraphs (150-200 words total). First sentence restates the correct answer explicitly. Tone: informative, factual, no fluff. Include why it matters + historical context + interesting detail.
   - `corrections`: Object where keys are the INDEX (as string) of each WRONG answer option. Each value is a 1-2 sentence specific correction explaining why THAT particular option is wrong. E.g., for a question where option 0 is wrong: `{ "0": "Eight amendments would only cover... The actual Bill of Rights contains 10 amendments." }`
   - `source`: Object with `name` (e.g., "U.S. Constitution - Congress.gov") and `url` (real .gov URL like "https://constitution.congress.gov/browse/...")
   - Use ONLY these authoritative source domains: constitution.congress.gov, archives.gov, supremecourt.gov, senate.gov, house.gov, usa.gov
   - Answer-specific correction examples:
     - For "How many amendments in Bill of Rights?" where "8" is wrong option 0: corrections["0"] = "Eight is too few -- the Bill of Rights actually contains 10 amendments, covering fundamental rights like free speech, religion, and trial by jury."

3. Create `backend/src/scripts/generateLearningContent.ts`:
   - Script that reads questions.json, filters questions missing learningContent, and generates it via Claude API (@anthropic-ai/sdk)
   - Include the prompt template from RESEARCH.md Pattern 5
   - Include retry logic with exponential backoff
   - Include JSON validation of response structure
   - Include rate limiting (1 second between requests)
   - Script should be runnable with: `npx tsx backend/src/scripts/generateLearningContent.ts`
   - Reads CLAUDE_API_KEY from environment variable
   - Add a comment at top: "// Run: CLAUDE_API_KEY=sk-xxx npx tsx backend/src/scripts/generateLearningContent.ts"
   - Do NOT install @anthropic-ai/sdk yet (user will install when ready to run)

IMPORTANT: The `topicCategory` field must be added to ALL 120 questions. The `learningContent` field should be added to at least 15 questions. Questions without learningContent simply omit the field.

IMPORTANT: Keep the existing `topic` field unchanged on all questions (it's used elsewhere). The new `topicCategory` field is additional.
  </action>
  <verify>
    - `node -e "const q=JSON.parse(require('fs').readFileSync('backend/src/data/questions.json','utf8')); console.log('Total:', q.length); console.log('With topicCategory:', q.filter(x=>x.topicCategory).length); console.log('With learningContent:', q.filter(x=>x.learningContent).length); const cats=new Set(q.map(x=>x.topicCategory).filter(Boolean)); console.log('Categories:', [...cats].sort());"` shows all 120 with topicCategory, 15+ with learningContent, 9 categories
    - `backend/src/scripts/generateLearningContent.ts` exists and has valid TypeScript structure
    - JSON.parse of questions.json succeeds (valid JSON)
  </verify>
  <done>
    - All 120 questions have topicCategory field mapped to one of 9 granular categories
    - At least 15 questions have complete learningContent with paragraphs, corrections, and source
    - All 9 topic categories represented in learningContent subset
    - Generation script exists for bulk content creation
  </done>
</task>

</tasks>

<verification>
- `cd frontend && npx tsc --noEmit` -- type system compiles
- questions.json is valid JSON with topicCategory on all entries and learningContent on 15+
- TopicIcon.tsx has all 9 icon components with proper SVG markup
- @headlessui/react in frontend dependencies
</verification>

<success_criteria>
- LearningContent and TopicCategory types fully defined
- 9 topic icon SVG components with lookup map
- All 120 questions categorized with topicCategory
- 15+ questions have full learningContent (paragraphs + corrections + source)
- All 9 categories represented in content subset
- Generation script ready for future bulk use
- @headlessui/react installed
</success_criteria>

<output>
After completion, create `.planning/phases/04-learning-content/04-01-SUMMARY.md`
</output>
