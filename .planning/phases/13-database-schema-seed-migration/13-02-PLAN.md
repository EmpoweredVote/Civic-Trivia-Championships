---
phase: 13-database-schema-seed-migration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/src/db/seed/sources.json
autonomous: true

must_haves:
  truths:
    - "All 120 questions have authoritative source objects with name and URL"
    - "Sources reference official .gov, .edu, or established educational sites"
    - "No fabricated or hallucinated URLs"
  artifacts:
    - path: "backend/src/db/seed/sources.json"
      provides: "Source mapping for all 120 questions"
      contains: "q001.*url"
  key_links:
    - from: "backend/src/db/seed/sources.json"
      to: "backend/src/data/questions.json"
      via: "question ID matching"
      pattern: "q\\d{3}"
---

<objective>
Research and compile authoritative sources for the 87 questions that currently lack source citations.

Purpose: CONTEXT.md mandates "Source URL/name is a required field for ALL questions — enforces authoritative sourcing for civic content credibility." The 33 questions with learning content already have sources. The remaining 87 need authoritative .gov/.edu sources added before they can be migrated to PostgreSQL (where source is NOT NULL).

Output: A `sources.json` file mapping all 120 question IDs to their authoritative source objects. The 33 existing sources are preserved; 87 new sources are researched and added.
</objective>

<execution_context>
@C:\Users\Chris\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Chris\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/13-database-schema-seed-migration/13-CONTEXT.md
@backend/src/data/questions.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract existing sources and research missing ones</name>
  <files>
    backend/src/db/seed/sources.json
  </files>
  <action>
Create directory `backend/src/db/seed/` if it doesn't exist.

Read `backend/src/data/questions.json` and build a complete source mapping for ALL 120 questions.

**For the 33 questions WITH learningContent.source:** Extract their existing source objects directly. These are already verified.

**For the 87 questions WITHOUT sources:** Assign authoritative sources based on the question's topic and content. Use these priority sources:

1. **Constitution questions** -> National Archives (archives.gov/founding-docs), Constitution Annotated (constitution.congress.gov)
2. **Amendments questions** -> National Archives Bill of Rights (archives.gov/founding-docs/bill-of-rights), Constitution Annotated
3. **Branches of Government** -> USA.gov (usa.gov/branches-of-government), Congress.gov, WhiteHouse.gov
4. **Elections questions** -> USA.gov (usa.gov/voting), FEC.gov, Congress.gov
5. **Supreme Court questions** -> Supreme Court (supremecourt.gov), Oyez (oyez.org), Congress.gov
6. **Civic Participation** -> USA.gov, Congress.gov
7. **U.S. History** -> National Archives, Library of Congress (loc.gov), Smithsonian

For each unsourced question:
1. Read the question text and explanation
2. Identify the specific fact being tested
3. Select the most relevant authoritative source that covers that fact
4. Use a specific page URL, not just the site root (e.g., "https://www.archives.gov/founding-docs/constitution" not just "https://www.archives.gov")

**Source object format:**
```json
{
  "name": "Source Name - Organization",
  "url": "https://specific-page-url"
}
```

Write the complete mapping to `backend/src/db/seed/sources.json` as:
```json
{
  "q001": { "name": "U.S. Constitution - National Archives", "url": "https://www.archives.gov/founding-docs/bill-of-rights" },
  "q002": { "name": "Branches of Government - USA.gov", "url": "https://www.usa.gov/branches-of-government" },
  ...
}
```

CRITICAL WARNINGS (from RESEARCH.md Pitfall 6):
- DO NOT fabricate URLs. Use only well-known, stable government and educational URLs.
- Prefer .gov sources (archives.gov, usa.gov, congress.gov, supremecourt.gov, whitehouse.gov)
- Secondary: .edu sources and established sites (oyez.org for Supreme Court cases)
- Each source should plausibly contain information about the specific fact in the question
- When in doubt, use the broader topic page rather than guessing a specific sub-page
- It is acceptable to reuse the same source URL for multiple questions on the same topic (e.g., many Constitution questions can point to the same archives.gov page)
  </action>
  <verify>
Run a validation script:
```bash
cd backend && node -e "
const sources = JSON.parse(require('fs').readFileSync('src/db/seed/sources.json', 'utf8'));
const questions = JSON.parse(require('fs').readFileSync('src/data/questions.json', 'utf8'));
const sourceKeys = Object.keys(sources);
const questionIds = questions.map(q => q.id);

console.log('Sources count:', sourceKeys.length);
console.log('Questions count:', questionIds.length);

// Check all questions have sources
const missing = questionIds.filter(id => !sources[id]);
console.log('Missing sources:', missing.length, missing);

// Check all sources have valid format
const invalid = sourceKeys.filter(id => !sources[id].name || !sources[id].url);
console.log('Invalid format:', invalid.length, invalid);

// Check URLs start with https
const noHttps = sourceKeys.filter(id => !sources[id].url.startsWith('https://'));
console.log('Non-HTTPS:', noHttps.length, noHttps);

// Check for .gov or known educational domains
const domains = [...new Set(sourceKeys.map(id => new URL(sources[id].url).hostname))];
console.log('Unique domains:', domains);
"
```
Expected: 120 sources, 0 missing, 0 invalid, 0 non-HTTPS, domains are all .gov or established educational sites.
  </verify>
  <done>
- sources.json contains exactly 120 entries (one per question ID)
- All 33 existing sources preserved exactly as-is
- All 87 new sources reference authoritative .gov/.edu sites
- Every source has name (string) and url (string starting with https://)
- No fabricated URLs — all are well-known stable government/educational pages
  </done>
</task>

</tasks>

<verification>
1. `sources.json` has 120 entries matching all question IDs in questions.json
2. All source objects have `name` and `url` fields
3. All URLs are HTTPS
4. Domains are authoritative (.gov, .edu, or established educational sites)
5. The 33 pre-existing sources match their original values exactly
</verification>

<success_criteria>
- Every question ID (q001-q120) has an authoritative source in sources.json
- Sources are plausible for their question content (not random assignments)
- File is valid JSON and ready for consumption by the seed script
</success_criteria>

<output>
After completion, create `.planning/phases/13-database-schema-seed-migration/13-02-SUMMARY.md`
</output>
